import{k,ba as C,bb as S,h as x,d as N,b8 as L,r as m,c as P,o as U,R as z,S as B,U as s,f as a,a0 as o,a6 as y,$ as f,aa as R,a3 as w,W as v,aI as $,a5 as _,_ as D}from "./index-CLxRvZYn.js";import{Q as F}from "./QForm-BGxHd8hi.js";import{Q as A}from "./QPage-Bc8lWIhV.js";import{a as H,b as q}from "./QLayout-D-mfyFZX.js";import{u as E}from "./use-quasar-DkPXY9po.js";import{api as h}from "./axios-DLpAuOl3.js";import{_ as j}from "./_plugin-vue_export-helper-DlAUqK2U.js";const G='<circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="60" cy="15" r="9" fill-opacity=".3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from=".5" to=".5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite"></animate></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite"></animate><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite"></animate></circle>',W=k({name:"QSpinnerDots",props:C,setup(u){const{cSize:l,classes:i}=S(u);return()=>x("svg",{class:i.value,fill:"currentColor",width:l.value,height:l.value,viewBox:"0 0 120 30",xmlns:"http://www.w3.org/2000/svg",innerHTML:G})}}),Y='<rect x="0" y="0" width="100" height="100" fill="none"></rect><g transform="translate(25 25)"><rect x="-20" y="-20" width="40" height="40" fill="currentColor" opacity="0.9"><animateTransform attributeName="transform" type="scale" from="1.5" to="1" repeatCount="indefinite" begin="0s" dur="1s" calcMode="spline" keySplines="0.2 0.8 0.2 0.8" keyTimes="0;1"></animateTransform></rect></g><g transform="translate(75 25)"><rect x="-20" y="-20" width="40" height="40" fill="currentColor" opacity="0.8"><animateTransform attributeName="transform" type="scale" from="1.5" to="1" repeatCount="indefinite" begin="0.1s" dur="1s" calcMode="spline" keySplines="0.2 0.8 0.2 0.8" keyTimes="0;1"></animateTransform></rect></g><g transform="translate(25 75)"><rect x="-20" y="-20" width="40" height="40" fill="currentColor" opacity="0.7"><animateTransform attributeName="transform" type="scale" from="1.5" to="1" repeatCount="indefinite" begin="0.3s" dur="1s" calcMode="spline" keySplines="0.2 0.8 0.2 0.8" keyTimes="0;1"></animateTransform></rect></g><g transform="translate(75 75)"><rect x="-20" y="-20" width="40" height="40" fill="currentColor" opacity="0.6"><animateTransform attributeName="transform" type="scale" from="1.5" to="1" repeatCount="indefinite" begin="0.2s" dur="1s" calcMode="spline" keySplines="0.2 0.8 0.2 0.8" keyTimes="0;1"></animateTransform></rect></g>',J=k({name:"QSpinnerCube",props:C,setup(u){const{cSize:l,classes:i}=S(u);return()=>x("svg",{class:i.value,width:l.value,height:l.value,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",innerHTML:Y})}}),K="/assets/logo-CSuo25zG.jpg",O={class:"login-container"},X={class:"logo-container"},Z={class:"input-group"},ee={class:"input-group"},ae={class:"remember-section"},te={class:"button-section"},se={class:"extra-options"},oe=N({__name:"LoginPage",setup(u){const l=L(),i=E(),r=m({username:"",password:""}),g=m(!1),d=m(!1),c=m(!1),p=m(!1),T=[e=>e&&e.length>0||"請輸入使用者名稱", e=>e.length>=3||"使用者名稱至少需要3個字符"],Q=[e=>e&&e.length>0||"請輸入密碼", e=>e.length>=6||"密碼至少需要6個字符"],b=P(()=>r.value.username.length>=3&&r.value.password.length>=6),M=()=>{d.value=!d.value},V=async()=>{if(b.value)try{g.value=!0,p.value=!0;const{data:e}=await h.post("/login",{username:r.value.username,password:r.value.password});localStorage.setItem("username",e.username),localStorage.setItem("nickname",e.nickname),localStorage.setItem("role",e.role),localStorage.setItem("accessToken",e.accessToken),localStorage.setItem("refreshToken",e.refreshToken),localStorage.removeItem("rememberedUsername"),c.value&&localStorage.setItem("rememberedUsername",e.username),h.defaults.headers.common.Authorization=`Bearer ${e.accessToken}`,i.notify({type:"positive",message:`歡迎回來，${e.nickname}！`,position:"top",timeout:2e3}),await l.push("/")}catch(e){r.value.password="",localStorage.removeItem("rememberedUsername"),c.value=!1,console.error("登入失敗",e)}finally{g.value=!1,p.value=!1}},I=()=>{i.dialog({title:"忘記密碼",message:"此功能尚未實裝，請聯繫系統管理員重設密碼",ok:{label:"確定",color:"primary"}})};return U(()=>{r.value.username="admin",r.value.password="123456";const e=localStorage.getItem("rememberedUsername");e&&(r.value.username=e,r.value.password="",c.value=!0)}),(e, t)=>(B(),z(q,null,{default:s(()=>[a(H,null,{default:s(()=>[a(A,{class:"login-page"},{default:s(()=>[t[8]||(t[8]=o("div",{class:"background-decorations"},[o("div",{class:"decoration decoration-1"}),o("div",{class:"decoration decoration-2"}),o("div",{class:"decoration decoration-3"}),o("div",{class:"decoration decoration-4"})],-1)),o("div",O,[a(y,{class:"login-card glass-card"},{default:s(()=>[a(f,{class:"logo-section"},{default:s(()=>[o("div",X,[a(R,{size:"80px",class:"logo-avatar"},{default:s(()=>t[4]||(t[4]=[o("img",{src:K,alt:"ERP Logo"},null,-1)])),_:1,__:[4]})])]),_:1}),a(f,{class:"title-section"},{default:s(()=>t[5]||(t[5]=[o("h1",{class:"app-title"},"凱亞 ERP 系統",-1),o("p",{class:"app-subtitle"},"進銷存管理",-1)])),_:1,__:[5]}),a(f,{class:"form-section"},{default:s(()=>[a(F,{onSubmit:V,class:"login-form"},{default:s(()=>[o("div",Z,[a(w,{modelValue:r.value.username,"onUpdate:modelValue":t[0]||(t[0]= n=>r.value.username=n),label:"使用者名稱",filled:"",dense:"",rules:T,class:"modern-input",color:"primary"},{prepend:s(()=>[a(v,{name:"person",color:"primary"})]),_:1},8,["modelValue"])]),o("div",ee,[a(w,{modelValue:r.value.password,"onUpdate:modelValue":t[1]||(t[1]= n=>r.value.password=n),type:d.value?"text":"password",label:"密碼",filled:"",dense:"",rules:Q,class:"modern-input",color:"primary"},{prepend:s(()=>[a(v,{name:"lock",color:"primary"})]),append:s(()=>[a(v,{name:d.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:M,color:"primary"},null,8,["name"])]),_:1},8,["modelValue","type"])]),o("div",ae,[a($,{modelValue:c.value,"onUpdate:modelValue":t[2]||(t[2]= n=>c.value=n),label:"記住我",color:"primary",class:"modern-checkbox"},null,8,["modelValue"])]),o("div",te,[a(_,{type:"submit",label:"登入",color:"primary",size:"lg",class:"login-btn modern-sleek-btn",loading:g.value,disable:!b.value,"no-caps":"",rounded:"",unelevated:""},{loading:s(()=>[a(W,{color:"white",size:"18px"})]),default:s(()=>[t[6]||(t[6]=o("div",{class:"btn-accent"},null,-1))]),_:1,__:[6]},8,["loading","disable"])]),o("div",se,[a(_,{flat:"","no-caps":"",label:"忘記密碼？",color:"primary",class:"forgot-password-btn",onClick:I})])]),_:1})]),_:1})]),_:1})]),a(D,{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]= n=>p.value=n),persistent:""},{default:s(()=>[a(y,{class:"loading-card"},{default:s(()=>[a(f,{class:"row items-center"},{default:s(()=>[a(J,{color:"primary",size:"2em"}),t[7]||(t[7]=o("span",{class:"q-ml-sm",black:""},"正在登入中...",-1))]),_:1,__:[7]})]),_:1})]),_:1},8,["modelValue"])]),_:1,__:[8]})]),_:1})]),_:1}))}}),de=j(oe,[["__scopeId","data-v-beafba9d"]]);export{de as default};
