import{k as ge,a as Qe,m as J,aj as _e,c as I,q as Ve,h as _,W as d,l as te,H as De,J as $e,g as Ne,ak as Ae,d as Pe,r as f,ag as Te,o as ze,R as k,S as m,U as s,a0 as t,f as l,X as c,a5 as h,a6 as p,$ as g,Y as r,a3 as K,V as C,aa as ue,_ as ce,ai as Ie,P as X,a1 as me,ab as D,a4 as ve}from "./index-CLxRvZYn.js";import{e as Be,f as z,h as Re}from "./QSelect-BUHZvF4Q.js";import{a as fe,b as x,Q as Ee}from "./QTable-B-UTUnxZ.js";import{Q as Y,S as Ue}from "./ShippingForm-Bl4cHboV.js";import{Q as Le}from "./QPage-Bc8lWIhV.js";import{C as G}from "./ClosePopup-BHTxnMEi.js";import{u as Me}from "./use-quasar-DkPXY9po.js";import{u as Fe,e as je}from "./MainLayout-store-C26opbpP.js";import{api as Z}from "./axios-DLpAuOl3.js";import{_ as We}from "./_plugin-vue_export-helper-DlAUqK2U.js";import"./QForm-BGxHd8hi.js";const ee=ge({name:"QTimelineEntry",props:{heading:Boolean,tag:{type:String,default:"h3"},side:{type:String,default:"right",validator: n=>["left","right"].includes(n)},icon:String,avatar:String,color:String,title:String,subtitle:String,body:String},setup(n, {slots:O}){const v=Qe(_e,J);if(v===J)return console.error("QTimelineEntry needs to be child of QTimeline"),J;const y=I(()=>`q-timeline__entry q-timeline__entry--${n.side}`+(n.icon!==void 0||n.avatar!==void 0?" q-timeline__entry--icon":"")),b=I(()=>`q-timeline__dot text-${n.color||v.color}`),Q=I(()=>v.layout==="comfortable"&&v.side==="left");return()=>{const w=Ve(O.default,[]);if(n.body!==void 0&&w.unshift(n.body),n.heading===!0){const N=[_("div"),_("div"),_(n.tag,{class:"q-timeline__heading-title"},w)];return _("div",{class:"q-timeline__heading"},Q.value===!0?N.reverse():N)}let q;n.icon!==void 0?q=[_(d,{class:"row items-center justify-center",name:n.icon})]:n.avatar!==void 0&&(q=[_("img",{class:"q-timeline__dot-img",src:n.avatar})]);const $=[_("div",{class:"q-timeline__subtitle"},[_("span",{},te(O.subtitle,[n.subtitle]))]),_("div",{class:b.value},q),_("div",{class:"q-timeline__content"},[_("h6",{class:"q-timeline__title"},te(O.title,[n.title]))].concat(w))];return _("li",{class:y.value},Q.value===!0?$.reverse():$)}}}),He=ge({name:"QTimeline",props:{...De,color:{type:String,default:"primary"},side:{type:String,default:"right",validator: n=>["left","right"].includes(n)},layout:{type:String,default:"dense",validator: n=>["dense","comfortable","loose"].includes(n)}},setup(n, {slots:O}){const v=Ne(),y=$e(n,v.proxy.$q);Ae(_e,n);const b=I(()=>`q-timeline q-timeline--${n.layout} q-timeline--${n.layout}--${n.side}`+(y.value===!0?" q-timeline--dark":""));return()=>_("ul",{class:b.value},te(O.default))}}),Je={class:"q-gutter-md"},Ke={class:"page-header"},Xe={class:"row items-center justify-between"},Ye={class:"col-auto"},Ge={class:"text-h4 text-weight-bold text-primary"},Ze={class:"col-auto"},et={class:"row q-col-gutter-md"},tt={class:"col-xs-12 col-sm-6 col-md-3"},lt={class:"row items-center q-gutter-md"},st={class:"stat-value text-blue-8 q-mt-xs"},at={class:"col-xs-12 col-sm-6 col-md-3"},ot={class:"row items-center q-gutter-md"},it={class:"stat-value text-green-8 q-mt-xs"},nt={class:"col-xs-12 col-sm-6 col-md-3"},rt={class:"row items-center q-gutter-md"},dt={class:"stat-value text-orange-8 q-mt-xs"},ut={class:"col-xs-12 col-sm-6 col-md-3"},ct={class:"row items-center q-gutter-md"},mt={class:"stat-value text-purple-8 q-mt-xs"},vt={class:"row q-col-gutter-md"},ft={class:"col-12 col-md-4"},gt={class:"col-12 col-md-3"},_t={class:"col-12 col-md-3"},pt={class:"col-12 col-md-2"},bt={class:"row items-center"},ht={class:"row items-center"},yt={class:"text-weight-medium"},xt={class:"text-caption text-grey-6"},wt={class:"text-weight-bold text-green-8"},qt={class:"text-weight-medium"},St={class:"row q-gutter-xs"},kt={class:"full-width row flex-center text-grey-6 q-pa-xl"},Ct={class:"column items-center"},Ot={class:"row q-col-gutter-md"},Qt={class:"col-12 col-md-6"},Vt={class:"text-subtitle1 text-weight-bold text-primary q-mb-md"},Dt={class:"info-grid"},$t={class:"info-item"},Nt={class:"info-value"},At={class:"info-item"},Pt={class:"info-value"},Tt={class:"info-item"},zt={class:"info-value"},It={class:"info-item"},Bt={class:"info-value text-green-8 text-weight-bold text-h6"},Rt={key:0,class:"info-item"},Et={class:"info-value"},Ut={class:"col-12 col-md-6"},Lt={class:"text-subtitle1 text-weight-bold text-primary q-mb-md"},Mt={class:"info-grid"},Ft={class:"info-item"},jt={class:"info-value text-weight-medium"},Wt={class:"info-item"},Ht={class:"info-value"},Jt={key:0},Kt={key:1,class:"text-grey-6"},Xt={class:"info-item"},Yt={class:"info-value"},Gt={key:0},Zt={key:1,class:"text-grey-6"},el={class:"info-item"},tl={class:"info-value"},ll={key:0},sl={key:1,class:"text-grey-6"},al={class:"col-12"},ol={class:"text-subtitle1 text-weight-bold text-primary q-mb-md"},il={class:"row items-center"},nl={class:"text-weight-medium"},rl={class:"text-caption text-grey-6"},dl={class:"text-weight-medium"},ul={class:"text-weight-bold text-green-8"},cl={class:"col-12"},ml={class:"text-subtitle1 text-weight-bold text-primary q-mb-md"},vl={class:"q-mb-md"},fl=Pe({__name:"OrdersPage",setup(n){const O=Fe(),v=Me(),y=f([]),b=f(!1),Q=f(""),w=f(""),q=f(""),$=f(!1),N=f(!1),i=f(null),B=f(!1),A=f(null),P=f(""),U=f(!1),V=Te({totalOrders:0,shippedOrders:0,pendingOrders:0,monthlyRevenue:0}),L=f({sortBy:"createdAt",descending:!0,page:1,rowsPerPage:10,rowsNumber:0}),pe=[{label:"全部",value:""},{label:"待處理",value:"pending"},{label:"已出貨",value:"shipped"},{label:"已取消",value:"cancelled"}],be=[{name:"orderNumber",label:"訂單編號",field:"orderNumber",align:"left",sortable:!0},{name:"orderDate",label:"訂單日期",field:"orderDate",align:"left",sortable:!0},{name:"customerName",label:"客戶資訊",field:"customerName",align:"left",sortable:!0},{name:"orderStatus",label:"訂單狀態",field:"orderStatus",align:"center",sortable:!0},{name:"totalAmount",label:"總金額",field:"totalAmount",align:"right",sortable:!0},{name:"actions",label:"操作",field:()=>"",align:"center",sortable:!1}],he=[{name:"productName",label:"商品資訊",field:"productName",align:"left"},{name:"quantity",label:"數量",field:"quantity",align:"center"},{name:"salePrice",label:"單價",field:"salePrice",align:"right"},{name:"totalPrice",label:"小計",field:"totalPrice",align:"right"}],ye=I(()=>{let o=y.value;if(Q.value){const e=Q.value.toLowerCase();o=o.filter(a=>a.orderNumber.toLowerCase().includes(e)||a.customerName.toLowerCase().includes(e))}return w.value&&(o=o.filter(e=>e.orderStatus===w.value)),q.value&&(o=o.filter(e=>e.orderDate===q.value)),o}),T= o=>Math.floor(o).toLocaleString(),le= o=>new Date(o).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}),M= o=>new Date(o).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),se= o=>{switch(o){case"pending":return"orange";case"shipped":return"green";case"cancelled":return"red";default:return"grey"}},ae= o=>{switch(o){case"pending":return"schedule";case"shipped":return"local_shipping";case"cancelled":return"cancel";default:return"help"}},oe= o=>{switch(o){case"pending":return"待處理";case"shipped":return"已出貨";case"cancelled":return"已取消";default:return"未知"}},R=(o, e, a, S)=>{const j=performance.now(),W=e-o,u= H=>{const ke=H-j,de=Math.min(ke/a,1),Ce=1-Math.pow(1-de,4),Oe=o+W*Ce;S(Oe),de<1&&requestAnimationFrame(u)};requestAnimationFrame(u)};function F(o, e){const a=o.length,S=o.filter(u=>u.orderStatus==="shipped").length,j=o.filter(u=>u.orderStatus==="pending").length,W=o.reduce((u, H)=>u+H.totalAmount,0);setTimeout(()=>{R(0,a,1e3, u=>{e.totalOrders=u}),R(0,S,1200, u=>{e.shippedOrders=u}),R(0,j,1400, u=>{e.pendingOrders=u}),R(0,W,1600, u=>{e.monthlyRevenue=u})},300)}const E=async()=>{b.value=!0;try{const o=await Z.get("/saleOrder");y.value=o.data,L.value.rowsNumber=y.value.length,F(y.value,V)}catch(o){console.error("Error fetching orders:",o),v.notify({color:"negative",message:"獲取訂單資料失敗",icon:"error",position:"top"})}finally{b.value=!1}},xe= o=>{i.value=o,N.value=!0};function we(){return new Promise(o=>{v.dialog({title:"處理中→已出貨",message:"將扣除庫存數量",ok:{label:"確定",color:"positive"},cancel:{label:"取消",color:"negative"},persistent:!0}).onOk(()=>{o(!0)}).onCancel(()=>{o(!1)})})}const ie=async(o, e)=>{if(!(b.value||!await we()))try{b.value=!0,await Z.put(`/saleOrder/${o.orderId}/status`,{status:e}),o.orderStatus=e,o.updatedAt=new Date().toISOString(),e==="shipped"&&(o.shippedAt=new Date().toISOString()),F(y.value,V),v.notify({color:"positive",message:"訂單狀態已更新",icon:"done",position:"top"})}catch(S){console.error("Error updating order status:",S),v.notify({color:"negative",message:"更新訂單狀態失敗",icon:"error",position:"top"})}finally{b.value=!1}},ne= o=>{A.value=o,P.value="",B.value=!0},qe=async()=>{if(A.value){U.value=!0;try{await Z.put(`/saleOrder/${A.value.orderId}/cancel`,{reason:P.value||""}),F(y.value,V),v.notify({color:"positive",message:"訂單已取消",icon:"done",position:"top"}),B.value=!1,A.value=null,P.value="",E()}catch(o){console.error("Error cancelling order:",o),v.notify({color:"negative",message:"取消訂單失敗",icon:"error",position:"top"})}finally{U.value=!1}}},re=()=>{E()},Se= o=>{L.value=o.pagination};return ze(()=>{O.resetOrdersBadge(),E(),je.on("sale-order-added",re)}),(o, e)=>(m(),k(Le,{class:"orders-page q-pa-md"},{default:s(()=>[t("div",Je,[t("div",Ke,[t("div",Xe,[t("div",Ye,[t("div",Ge,[l(d,{name:"receipt_long",class:"q-mr-sm"}),e[10]||(e[10]=c(" 訂單管理 "))]),e[11]||(e[11]=t("div",{class:"text-subtitle1 text-grey-6 q-mt-xs"},"管理和追蹤所有銷售訂單",-1))]),t("div",Ze,[l(h,{color:"primary",icon:"add",label:"新增訂單",unelevated:"",onClick:e[0]||(e[0]= a=>$.value=!0),class:"q-px-lg"})])])]),t("div",et,[t("div",tt,[l(p,{class:"stat-card bg-blue-1",flat:"",bordered:""},{default:s(()=>[l(g,null,{default:s(()=>[t("div",lt,[l(d,{name:"receipt",size:"md",class:"text-blue-7"}),t("div",null,[e[12]||(e[12]=t("div",{class:"text-subtitle2 text-grey-7"},"總訂單數",-1)),t("div",st,r(Math.floor(V.totalOrders)),1)])])]),_:1})]),_:1})]),t("div",at,[l(p,{class:"stat-card bg-green-1",flat:"",bordered:""},{default:s(()=>[l(g,null,{default:s(()=>[t("div",ot,[l(d,{name:"local_shipping",size:"md",class:"text-green-7"}),t("div",null,[e[13]||(e[13]=t("div",{class:"text-subtitle2 text-grey-7"},"已出貨",-1)),t("div",it,r(Math.floor(V.shippedOrders)),1)])])]),_:1})]),_:1})]),t("div",nt,[l(p,{class:"stat-card bg-orange-1",flat:"",bordered:""},{default:s(()=>[l(g,null,{default:s(()=>[t("div",rt,[l(d,{name:"schedule",size:"md",class:"text-orange-7"}),t("div",null,[e[14]||(e[14]=t("div",{class:"text-subtitle2 text-grey-7"},"待處理",-1)),t("div",dt,r(Math.floor(V.pendingOrders)),1)])])]),_:1})]),_:1})]),t("div",ut,[l(p,{class:"stat-card bg-purple-1",flat:"",bordered:""},{default:s(()=>[l(g,null,{default:s(()=>[t("div",ct,[l(d,{name:"trending_up",size:"md",class:"text-purple-7"}),t("div",null,[e[15]||(e[15]=t("div",{class:"text-subtitle2 text-grey-7"},"本月營業額",-1)),t("div",mt," $"+r(T(V.monthlyRevenue)),1)])])]),_:1})]),_:1})])]),l(p,{flat:"",bordered:"",class:"search-card"},{default:s(()=>[l(g,null,{default:s(()=>[t("div",vt,[t("div",ft,[l(K,{modelValue:Q.value,"onUpdate:modelValue":e[1]||(e[1]= a=>Q.value=a),filled:"",dense:"",placeholder:"搜索訂單編號或客戶名稱...",debounce:"300",clearable:""},{append:s(()=>[l(d,{name:"search"})]),_:1},8,["modelValue"])]),t("div",gt,[l(Be,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]= a=>w.value=a),filled:"",dense:"",label:"訂單狀態",options:pe,"emit-value":"","map-options":"",clearable:""},null,8,["modelValue"])]),t("div",_t,[l(K,{modelValue:q.value,"onUpdate:modelValue":e[3]||(e[3]= a=>q.value=a),filled:"",dense:"",label:"訂單日期",type:"date",clearable:""},null,8,["modelValue"])]),t("div",pt,[l(h,{color:"primary",icon:"refresh",label:"重新整理",onClick:E,loading:b.value,unelevated:"",class:"full-width"},null,8,["loading"])])])]),_:1})]),_:1}),l(p,{flat:"",bordered:""},{default:s(()=>[l(fe,{rows:ye.value,columns:be,loading:b.value,pagination:L.value,"rows-per-page-options":[0,10,20,50],onRequest:Se,"row-key":"orderId",flat:"","binary-state-sort":"",class:"orders-table"},{"body-cell-orderNumber":s(a=>[l(x,{props:a},{default:s(()=>[t("div",bt,[l(z,{color:"blue-2","text-color":"blue-8",dense:"",class:"text-weight-medium"},{default:s(()=>[c(r(a.value),1)]),_:2},1024)])]),_:2},1032,["props"])]),"body-cell-orderStatus":s(a=>[l(x,{props:a},{default:s(()=>[l(z,{color:se(a.value),"text-color":"white",icon:ae(a.value),dense:"",class:"text-weight-medium"},{default:s(()=>[c(r(oe(a.value)),1)]),_:2},1032,["color","icon"])]),_:2},1032,["props"])]),"body-cell-customerName":s(a=>[l(x,{props:a},{default:s(()=>[t("div",ht,[l(ue,{size:"sm",color:"grey-4","text-color":"grey-8",class:"q-mr-sm"},{default:s(()=>[l(d,{name:"person"})]),_:1}),t("div",null,[t("div",yt,r(a.value),1),t("div",xt,r(a.row.customerPhone||"無電話"),1)])])]),_:2},1032,["props"])]),"body-cell-totalAmount":s(a=>[l(x,{props:a},{default:s(()=>[t("div",wt,"$"+r(T(a.value)),1)]),_:2},1032,["props"])]),"body-cell-orderDate":s(a=>[l(x,{props:a},{default:s(()=>[t("div",qt,r(le(a.value)),1)]),_:2},1032,["props"])]),"body-cell-actions":s(a=>[l(x,{props:a},{default:s(()=>[t("div",St,[l(h,{size:"sm",color:"primary",icon:"visibility",flat:"",round:"",onClick: S=>xe(a.row)},{default:s(()=>[l(Y,null,{default:s(()=>e[16]||(e[16]=[c("查看詳情")])),_:1,__:[16]})]),_:2},1032,["onClick"]),a.row.orderStatus==="pending"?(m(),k(h,{key:0,size:"sm",color:"green",icon:"local_shipping",flat:"",round:"",onClick: S=>ie(a.row,"shipped")},{default:s(()=>[l(Y,null,{default:s(()=>e[17]||(e[17]=[c("標記已出貨")])),_:1,__:[17]})]),_:2},1032,["onClick"])):C("",!0),a.row.orderStatus==="pending"?(m(),k(h,{key:1,size:"sm",color:"red",icon:"cancel",flat:"",round:"",onClick: S=>ne(a.row)},{default:s(()=>[l(Y,null,{default:s(()=>e[18]||(e[18]=[c("取消訂單")])),_:1,__:[18]})]),_:2},1032,["onClick"])):C("",!0)])]),_:2},1032,["props"])]),"no-data":s(()=>[t("div",kt,[t("div",Ct,[l(d,{name:"receipt_long",size:"4rem",class:"q-mb-md"}),e[19]||(e[19]=t("div",{class:"text-h6 q-mb-sm"},"暫無訂單資料",-1)),e[20]||(e[20]=t("div",{class:"text-subtitle1"},"請新增您的第一筆訂單",-1))])])]),_:1},8,["rows","loading","pagination"])]),_:1}),l(ce,{modelValue:N.value,"onUpdate:modelValue":e[6]||(e[6]= a=>N.value=a),maximized:Ie(v).screen.lt.md},{default:s(()=>[l(p,{class:"order-details-card",style:{"min-width":"800px","max-width":"90vw","max-height":"90vh"}},{default:s(()=>[l(g,{class:"row items-center q-pb-none bg-primary text-white"},{default:s(()=>[l(d,{name:"receipt_long",size:"md",class:"q-mr-sm"}),e[21]||(e[21]=t("div",{class:"text-h6"},"訂單詳情",-1)),l(Ee),X(l(h,{icon:"close",flat:"",round:"",dense:"",color:"white"},null,512),[[G]])]),_:1,__:[21]}),l(me),i.value?(m(),k(g,{key:0,class:"scroll",style:{"max-height":"70vh"}},{default:s(()=>[t("div",Ot,[t("div",Qt,[l(p,{flat:"",bordered:"",class:"info-card"},{default:s(()=>[l(g,null,{default:s(()=>[t("div",Vt,[l(d,{name:"receipt",class:"q-mr-sm"}),e[22]||(e[22]=c(" 訂單資訊 "))]),t("div",Dt,[t("div",$t,[e[23]||(e[23]=t("div",{class:"info-label"},"訂單編號",-1)),t("div",Nt,[l(z,{color:"blue-2","text-color":"blue-8",dense:""},{default:s(()=>[c(r(i.value.orderNumber),1)]),_:1})])]),t("div",At,[e[24]||(e[24]=t("div",{class:"info-label"},"訂單狀態",-1)),t("div",Pt,[l(z,{color:se(i.value.orderStatus),"text-color":"white",icon:ae(i.value.orderStatus),dense:""},{default:s(()=>[c(r(oe(i.value.orderStatus)),1)]),_:1},8,["color","icon"])])]),t("div",Tt,[e[25]||(e[25]=t("div",{class:"info-label"},"訂單日期",-1)),t("div",zt,r(le(i.value.orderDate)),1)]),t("div",It,[e[26]||(e[26]=t("div",{class:"info-label"},"總金額",-1)),t("div",Bt," $"+r(T(i.value.totalAmount)),1)]),i.value.notes?(m(),D("div",Rt,[e[27]||(e[27]=t("div",{class:"info-label"},"備註",-1)),t("div",Et,r(i.value.notes),1)])):C("",!0)])]),_:1})]),_:1})]),t("div",Ut,[l(p,{flat:"",bordered:"",class:"info-card"},{default:s(()=>[l(g,null,{default:s(()=>[t("div",Lt,[l(d,{name:"person",class:"q-mr-sm"}),e[28]||(e[28]=c(" 客戶資訊 "))]),t("div",Mt,[t("div",Ft,[e[29]||(e[29]=t("div",{class:"info-label"},"客戶名稱",-1)),t("div",jt,r(i.value.customerName),1)]),t("div",Wt,[e[30]||(e[30]=t("div",{class:"info-label"},"聯絡電話",-1)),t("div",Ht,[i.value.customerPhone?(m(),D("span",Jt,[l(d,{name:"phone",class:"q-mr-xs"}),c(" "+r(i.value.customerPhone),1)])):(m(),D("span",Kt,"無"))])]),t("div",Xt,[e[31]||(e[31]=t("div",{class:"info-label"},"電子郵件",-1)),t("div",Yt,[i.value.customerEmail?(m(),D("span",Gt,[l(d,{name:"email",class:"q-mr-xs"}),c(" "+r(i.value.customerEmail),1)])):(m(),D("span",Zt,"無"))])]),t("div",el,[e[32]||(e[32]=t("div",{class:"info-label"},"客戶地址",-1)),t("div",tl,[i.value.customerAddress?(m(),D("span",ll,[l(d,{name:"location_on",class:"q-mr-xs"}),c(" "+r(i.value.customerAddress),1)])):(m(),D("span",sl,"無"))])])])]),_:1})]),_:1})]),t("div",al,[l(p,{flat:"",bordered:"",class:"items-card"},{default:s(()=>[l(g,null,{default:s(()=>[t("div",ol,[l(d,{name:"shopping_cart",class:"q-mr-sm"}),e[33]||(e[33]=c(" 訂單項目 ")),l(z,{color:"grey-4","text-color":"grey-8",dense:"",label:`共 ${i.value.orderItems.length} 項`,class:"q-ml-sm"},null,8,["label"])]),l(fe,{rows:i.value.orderItems,columns:he,"row-key":"orderItemId",flat:"",dense:"","hide-pagination":"",pagination:{rowsPerPage:0},class:"detail-items-table"},{"body-cell-productName":s(a=>[l(x,{props:a},{default:s(()=>[t("div",il,[l(ue,{size:"sm",color:"blue-1","text-color":"blue-8",class:"q-mr-sm"},{default:s(()=>[l(d,{name:"inventory"})]),_:1}),t("div",null,[t("div",nl,r(a.value),1),t("div",rl,r(a.row.productSku),1)])])]),_:2},1032,["props"])]),"body-cell-quantity":s(a=>[l(x,{props:a},{default:s(()=>[l(Re,{color:"blue-2","text-color":"blue-8",label:a.value,class:"q-px-sm"},null,8,["label"])]),_:2},1032,["props"])]),"body-cell-salePrice":s(a=>[l(x,{props:a},{default:s(()=>[t("div",dl,"$"+r(T(a.value)),1)]),_:2},1032,["props"])]),"body-cell-totalPrice":s(a=>[l(x,{props:a},{default:s(()=>[t("div",ul," $"+r(T(a.value)),1)]),_:2},1032,["props"])]),_:1},8,["rows"])]),_:1})]),_:1})]),t("div",cl,[l(p,{flat:"",bordered:"",class:"timeline-card"},{default:s(()=>[l(g,null,{default:s(()=>[t("div",ml,[l(d,{name:"schedule",class:"q-mr-sm"}),e[34]||(e[34]=c(" 訂單時間軸 "))]),l(He,null,{default:s(()=>[l(ee,{color:"primary",icon:"add_circle",title:M(i.value.createdAt),subtitle:"訂單建立"},null,8,["title"]),i.value.shippedAt?(m(),k(ee,{key:0,color:"positive",icon:"local_shipping",title:M(i.value.shippedAt),subtitle:"訂單出貨"},null,8,["title"])):C("",!0),i.value.cancelledAt?(m(),k(ee,{key:1,color:"negative",icon:"cancel",title:M(i.value.cancelledAt),subtitle:`訂單取消 - ${i.value.cancelledReason||"無原因"}`},null,8,["title","subtitle"])):C("",!0)]),_:1})]),_:1})]),_:1})])])]),_:1})):C("",!0),l(me),l(ve,{align:"right",class:"bg-grey-1"},{default:s(()=>[i.value?.orderStatus==="pending"?(m(),k(h,{key:0,color:"negative",icon:"cancel",label:"取消訂單",onClick:e[4]||(e[4]= a=>ne(i.value)),outline:""})):C("",!0),i.value?.orderStatus==="pending"?(m(),k(h,{key:1,color:"positive",icon:"local_shipping",label:"標記已出貨",onClick:e[5]||(e[5]= a=>ie(i.value,"shipped")),unelevated:""})):C("",!0),X(l(h,{color:"primary",icon:"close",label:"關閉",flat:""},null,512),[[G]])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"]),l(ce,{modelValue:B.value,"onUpdate:modelValue":e[8]||(e[8]= a=>B.value=a),persistent:""},{default:s(()=>[l(p,{style:{"min-width":"400px"}},{default:s(()=>[l(g,null,{default:s(()=>e[35]||(e[35]=[t("div",{class:"text-h6 text-negative"},"取消訂單",-1)])),_:1,__:[35]}),l(g,null,{default:s(()=>[t("div",vl,[e[36]||(e[36]=c(" 將作廢訂單 ")),t("strong",null,r(A.value?.orderNumber),1)]),l(K,{modelValue:P.value,"onUpdate:modelValue":e[7]||(e[7]= a=>P.value=a),filled:"",type:"textarea",label:"取消原因",rows:"3",rules:[a=>!!a||"請輸入取消原因"]},null,8,["modelValue","rules"])]),_:1}),l(ve,{align:"right"},{default:s(()=>[X(l(h,{flat:"",label:"取消"},null,512),[[G]]),l(h,{color:"negative",label:"確定取消",onClick:qe,loading:U.value},null,8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),l(Ue,{modelValue:$.value,"onUpdate:modelValue":e[9]||(e[9]= a=>$.value=a),onSaleOrderAdded:re},null,8,["modelValue"])]),_:1}))}}),Cl=We(fl,[["__scopeId","data-v-08f310db"]]);export{Cl as default};
